
@using BusinessSchoolMLS.SchoolBusinessComponent;

@{
    ViewData["Title"] = "Module Activity Members";
    ModuleActivityBusinessComponent moduleActivityBusinessComponent = new ModuleActivityBusinessComponent();
    string mguid = ViewBag.MemGuid;
    List<StudentActivityMarkModel> lst_all_members = null;
    if (ViewBag.UnitCode != null && ViewBag.ActivityName != null && ViewBag.ActivityDate != null)
    {
        lst_all_members = moduleActivityBusinessComponent.GetAllMemberUnitMarkByActivityDate(ViewBag.UnitCode, ViewBag.ActivityName, ViewBag.ActivityDate);
    }
}


<div>
    &nbsp;
</div>
<div>
    <h4 style="color: #6d2829;">Unit Activity Students</h4>
</div>
<div>
    <form id="postForm" method="post" enctype="multipart/form-data">
        <input type="hidden" name="UserID" id="UserID" value="@mguid" />
        <div class="form-group">
            <label for="ActivityMarkValue">Upload Bulk Marks</label>
            <input type="file" name="FormFile" id="FormFile" class="form-control" />
        </div>
        <div class="form-group">
            <button type="submit" id="viewMark" class="btn btn-default" style="width: 100px;">View</button>
        </div>
    </form>
</div>
<div class="modal fade" id="viewUploadMarks" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Activity Mark</h5>
                <button type="submit" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div class="modal-body">
                <table class="table">
                    <thead>
                        <tr>
                            <th>IDNo</th>
                            <th>Unit Code</th>
                            <th>Activity Name</th>
                            <th>Activity Date</th>
                            <th>Mark</th>
                        </tr>
                    </thead>
                    <tbody id="mark-body"></tbody>
                    <tfoot>
                        <tr>
                            <td colspan="5">
                                <form method="post" action="/ModuleActivity/UploadBulkMark?mid=@mguid">
                                    <div class="form-group">
                                        <input type="submit" value="Upload" class="btn btn-default" />
                                    </div>
                                </form>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
</div>
@if (lst_all_members != null)
{
    <div>
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>FullName</th>
                        <th>Unit Code</th>
                        <th>Activity Name</th>
                        <th>Activity Date</th>
                        <th>Activity Mark</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var member in lst_all_members)
                    {
                        <tr>
                            <td>@member.FullName</td>
                            <td>@member.UnitCode</td>
                            <td>@member.ActivityName</td>
                            <td>@member.ActivityDate</td>
                            <td>@member.ActivityMarkValue</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

}
<script type="text/javascript" src="~/js/jquery-1.9.1.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {

        $("form#postForm").submit(function (e) {
            e.preventDefault();
            var formData = new FormData(this);
            $.ajax({
                url: "/ModuleActivity/UploadUnitActivityMark",
                type: "post",
                data: formData,
                success: function (data) {
                    $("#mark-body").html(data);
                    $("#viewUploadMarks").modal();
                },
                cache: false,
                contentType: false,
                processData: false
            });
        });
    });
</script>